plugins.withId('org.jetbrains.kotlin.multiplatform') {
  kotlin {
    if (plugins.hasPlugin('com.android.library')) {
      android {
        publishLibraryVariants('release')
      }
    }
    //iosArm32()
    iosArm64()
    iosX64()
    js {
      browser()
    }
    jvm()
    //macosX64()
    //mingwX64()
    //tvosX64()
    //tvosArm64()
    //watchosArm32()
    //watchosArm64()
    //macosArm64()
    iosSimulatorArm64()
    //watchosSimulatorArm64()
    //tvosSimulatorArm64()

    sourceSets {
      nativeMain {
      }

      nativeTest {
      }
    }

    targets.all { target ->
      // Some Kotlin targets do not have this property, but native ones always will.
      if (target.hasProperty('platformType') && target.platformType.name == "native") {
        target.compilations.main.source(sourceSets.nativeMain)
        target.compilations.test.source(sourceSets.nativeTest)
      }
    }
  }
}
