apply plugin: 'org.jetbrains.kotlin.multiplatform'
apply plugin: 'app.cash.treehouse'

kotlin {
  ios()
  js {
    browser {
      testTask {
        // TODO re-enable https://github.com/square/treehouse/issues/129
        enabled = false
      }
    }
  }
  jvm()

  sourceSets {
    commonMain {
      dependencies {
        api project(':samples:counter:sunspot:compose')
      }
    }
    commonTest {
      dependencies {
        implementation deps.kotlin.test
        implementation project(':samples:counter:sunspot:test')
        // TODO remove the need for these dependencies!
        implementation project(':samples:counter:sunspot:compose:protocol')
        implementation project(':samples:counter:sunspot:widget:protocol')
      }
    }
    nativeTest {
    }
  }

  configure([
    targets.iosArm64,
    targets.iosX64,
  ]) {
    compilations.test.source(sourceSets.nativeTest)
  }
}
