apply plugin: 'org.jetbrains.kotlin.multiplatform'
apply plugin: 'app.cash.redwood.build'

redwoodBuild {
  publishing()
}

kotlin {
  iosArm64()
  iosX64()
  iosSimulatorArm64()

  sourceSets {
    commonMain {
      dependencies {
        api projects.redwoodTreehouseLazylayoutWidget
        implementation projects.redwoodTreehouseHost
        implementation projects.redwoodWidgetCompose
      }
    }
  }
}

// TODO: find a way to get Objective-C conflicting overloads to play nice with Kotlin metadata.
// https://kotlinlang.slack.com/archives/C9JM6Q2UX/p1683686935270659
tasks.configureEach { task ->
  if (task.name == "compileCommonMainKotlinMetadata") {
    task.onlyIf { false }
  }
}
